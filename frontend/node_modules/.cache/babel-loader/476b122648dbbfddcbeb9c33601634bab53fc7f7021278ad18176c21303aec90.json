{"ast":null,"code":"\"use strict\";\n\n/**\n * Copyright 2022 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Deferred = void 0;\nclass Deferred {\n  #isFinished = false;\n  #promise;\n  #result;\n  #resolve;\n  #reject;\n  get isFinished() {\n    return this.#isFinished;\n  }\n  get result() {\n    if (!this.#isFinished) {\n      throw new Error('Deferred is not finished yet');\n    }\n    return this.#result;\n  }\n  constructor() {\n    this.#promise = new Promise((resolve, reject) => {\n      this.#resolve = resolve;\n      this.#reject = reject;\n    });\n    // Needed to avoid `Uncaught (in promise)`. The promises returned by `then`\n    // and `catch` will be rejected anyway.\n    this.#promise.catch(_error => {\n      // Intentionally empty.\n    });\n  }\n  then(onFulfilled, onRejected) {\n    return this.#promise.then(onFulfilled, onRejected);\n  }\n  catch(onRejected) {\n    return this.#promise.catch(onRejected);\n  }\n  resolve(value) {\n    this.#result = value;\n    if (!this.#isFinished) {\n      this.#isFinished = true;\n      this.#resolve(value);\n    }\n  }\n  reject(reason) {\n    if (!this.#isFinished) {\n      this.#isFinished = true;\n      this.#reject(reason);\n    }\n  }\n  finally(onFinally) {\n    return this.#promise.finally(onFinally);\n  }\n  [Symbol.toStringTag] = 'Promise';\n}\nexports.Deferred = Deferred;","map":{"version":3,"names":["Deferred","isFinished","promise","result","resolve","reject","Error","constructor","Promise","catch","_error","then","onFulfilled","onRejected","value","reason","finally","onFinally","Symbol","toStringTag","exports"],"sources":["../../../src/utils/Deferred.ts"],"sourcesContent":[null],"mappings":";;AAAA;;;;;;;;;;;;;;;;;;;;AAiBA,MAAaA,QAAQ;EACnB,CAAAC,UAAW,GAAG,KAAK;EACnB,CAAAC,OAAQ;EACR,CAAAC,MAAO;EACP,CAAAC,OAAQ;EACR,CAAAC,MAAO;EAEP,IAAIJ,UAAUA,CAAA;IACZ,OAAO,IAAI,CAAC,CAAAA,UAAW;EACzB;EAEA,IAAIE,MAAMA,CAAA;IACR,IAAI,CAAC,IAAI,CAAC,CAAAF,UAAW,EAAE;MACrB,MAAM,IAAIK,KAAK,CAAC,8BAA8B,CAAC;IACjD;IACA,OAAO,IAAI,CAAC,CAAAH,MAAQ;EACtB;EAEAI,YAAA;IACE,IAAI,CAAC,CAAAL,OAAQ,GAAG,IAAIM,OAAO,CAAC,CAACJ,OAAO,EAAEC,MAAM,KAAI;MAC9C,IAAI,CAAC,CAAAD,OAAQ,GAAGA,OAAO;MACvB,IAAI,CAAC,CAAAC,MAAO,GAAGA,MAAM;IACvB,CAAC,CAAC;IACF;IACA;IACA,IAAI,CAAC,CAAAH,OAAQ,CAACO,KAAK,CAAEC,MAAM,IAAI;MAC7B;IAAA,CACD,CAAC;EACJ;EAEAC,IAAIA,CACFC,WAAqE,EACrEC,UAA2E;IAE3E,OAAO,IAAI,CAAC,CAAAX,OAAQ,CAACS,IAAI,CAACC,WAAW,EAAEC,UAAU,CAAC;EACpD;EAEAJ,KAAKA,CACHI,UAAyE;IAEzE,OAAO,IAAI,CAAC,CAAAX,OAAQ,CAACO,KAAK,CAACI,UAAU,CAAC;EACxC;EAEAT,OAAOA,CAACU,KAAQ;IACd,IAAI,CAAC,CAAAX,MAAO,GAAGW,KAAK;IACpB,IAAI,CAAC,IAAI,CAAC,CAAAb,UAAW,EAAE;MACrB,IAAI,CAAC,CAAAA,UAAW,GAAG,IAAI;MACvB,IAAI,CAAC,CAAAG,OAAQ,CAACU,KAAK,CAAC;IACtB;EACF;EAEAT,MAAMA,CAACU,MAAe;IACpB,IAAI,CAAC,IAAI,CAAC,CAAAd,UAAW,EAAE;MACrB,IAAI,CAAC,CAAAA,UAAW,GAAG,IAAI;MACvB,IAAI,CAAC,CAAAI,MAAO,CAACU,MAAM,CAAC;IACtB;EACF;EAEAC,OAAOA,CAACC,SAA+B;IACrC,OAAO,IAAI,CAAC,CAAAf,OAAQ,CAACc,OAAO,CAACC,SAAS,CAAC;EACzC;EAEA,CAACC,MAAM,CAACC,WAAW,IAAI,SAAS;;AA9DlCC,OAAA,CAAApB,QAAA,GAAAA,QAAA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}