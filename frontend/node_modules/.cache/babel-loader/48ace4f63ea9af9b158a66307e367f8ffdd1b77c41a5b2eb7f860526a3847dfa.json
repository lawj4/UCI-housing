{"ast":null,"code":"\"use strict\";\n\n/**\n * @license\n * Copyright 2022 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nvar __esDecorate = this && this.__esDecorate || function (ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) {\n    if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\");\n    return f;\n  }\n  var kind = contextIn.kind,\n    key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _,\n    done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n    var context = {};\n    for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n    for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n    context.addInitializer = function (f) {\n      if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\");\n      extraInitializers.push(accept(f || null));\n    };\n    var result = (0, decorators[i])(kind === \"accessor\" ? {\n      get: descriptor.get,\n      set: descriptor.set\n    } : descriptor[key], context);\n    if (kind === \"accessor\") {\n      if (result === void 0) continue;\n      if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n      if (_ = accept(result.get)) descriptor.get = _;\n      if (_ = accept(result.set)) descriptor.set = _;\n      if (_ = accept(result.init)) initializers.unshift(_);\n    } else if (_ = accept(result)) {\n      if (kind === \"field\") initializers.unshift(_);else descriptor[key] = _;\n    }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\nvar __runInitializers = this && this.__runInitializers || function (thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n    value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\nvar __addDisposableResource = this && this.__addDisposableResource || function (env, value, async) {\n  if (value !== null && value !== void 0) {\n    if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n    var dispose;\n    if (async) {\n      if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n      dispose = value[Symbol.asyncDispose];\n    }\n    if (dispose === void 0) {\n      if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n      dispose = value[Symbol.dispose];\n    }\n    if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n    env.stack.push({\n      value: value,\n      dispose: dispose,\n      async: async\n    });\n  } else if (async) {\n    env.stack.push({\n      async: true\n    });\n  }\n  return value;\n};\nvar __disposeResources = this && this.__disposeResources || function (SuppressedError) {\n  return function (env) {\n    function fail(e) {\n      env.error = env.hasError ? new SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n      env.hasError = true;\n    }\n    function next() {\n      while (env.stack.length) {\n        var rec = env.stack.pop();\n        try {\n          var result = rec.dispose && rec.dispose.call(rec.value);\n          if (rec.async) return Promise.resolve(result).then(next, function (e) {\n            fail(e);\n            return next();\n          });\n        } catch (e) {\n          fail(e);\n        }\n      }\n      if (env.hasError) throw env.error;\n    }\n    return next();\n  };\n}(typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n});\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.BidiPage = void 0;\nconst rxjs_js_1 = require(\"../../third_party/rxjs/rxjs.js\");\nconst Page_js_1 = require(\"../api/Page.js\");\nconst Coverage_js_1 = require(\"../cdp/Coverage.js\");\nconst EmulationManager_js_1 = require(\"../cdp/EmulationManager.js\");\nconst Tracing_js_1 = require(\"../cdp/Tracing.js\");\nconst Errors_js_1 = require(\"../common/Errors.js\");\nconst EventEmitter_js_1 = require(\"../common/EventEmitter.js\");\nconst util_js_1 = require(\"../common/util.js\");\nconst assert_js_1 = require(\"../util/assert.js\");\nconst decorators_js_1 = require(\"../util/decorators.js\");\nconst encoding_js_1 = require(\"../util/encoding.js\");\nconst ErrorLike_js_1 = require(\"../util/ErrorLike.js\");\nconst Frame_js_1 = require(\"./Frame.js\");\nconst Input_js_1 = require(\"./Input.js\");\nconst util_js_2 = require(\"./util.js\");\n/**\n * Implements Page using WebDriver BiDi.\n *\n * @internal\n */\nlet BidiPage = (() => {\n  let _classSuper = Page_js_1.Page;\n  let _trustedEmitter_decorators;\n  let _trustedEmitter_initializers = [];\n  let _trustedEmitter_extraInitializers = [];\n  return class BidiPage extends _classSuper {\n    static {\n      const _metadata = typeof Symbol === \"function\" && Symbol.metadata ? Object.create(_classSuper[Symbol.metadata] ?? null) : void 0;\n      _trustedEmitter_decorators = [(0, decorators_js_1.bubble)()];\n      __esDecorate(this, null, _trustedEmitter_decorators, {\n        kind: \"accessor\",\n        name: \"trustedEmitter\",\n        static: false,\n        private: false,\n        access: {\n          has: obj => \"trustedEmitter\" in obj,\n          get: obj => obj.trustedEmitter,\n          set: (obj, value) => {\n            obj.trustedEmitter = value;\n          }\n        },\n        metadata: _metadata\n      }, _trustedEmitter_initializers, _trustedEmitter_extraInitializers);\n      if (_metadata) Object.defineProperty(this, Symbol.metadata, {\n        enumerable: true,\n        configurable: true,\n        writable: true,\n        value: _metadata\n      });\n    }\n    static from(browserContext, browsingContext) {\n      const page = new BidiPage(browserContext, browsingContext);\n      page.#initialize();\n      return page;\n    }\n    #trustedEmitter_accessor_storage = __runInitializers(this, _trustedEmitter_initializers, new EventEmitter_js_1.EventEmitter());\n    get trustedEmitter() {\n      return this.#trustedEmitter_accessor_storage;\n    }\n    set trustedEmitter(value) {\n      this.#trustedEmitter_accessor_storage = value;\n    }\n    #browserContext = __runInitializers(this, _trustedEmitter_extraInitializers);\n    #frame;\n    #viewport = null;\n    #workers = new Set();\n    keyboard;\n    mouse;\n    touchscreen;\n    tracing;\n    coverage;\n    #cdpEmulationManager;\n    #emulatedNetworkConditions;\n    _client() {\n      return this.#frame.client;\n    }\n    constructor(browserContext, browsingContext) {\n      super();\n      this.#browserContext = browserContext;\n      this.#frame = Frame_js_1.BidiFrame.from(this, browsingContext);\n      this.#cdpEmulationManager = new EmulationManager_js_1.EmulationManager(this.#frame.client);\n      this.tracing = new Tracing_js_1.Tracing(this.#frame.client);\n      this.coverage = new Coverage_js_1.Coverage(this.#frame.client);\n      this.keyboard = new Input_js_1.BidiKeyboard(this);\n      this.mouse = new Input_js_1.BidiMouse(this);\n      this.touchscreen = new Input_js_1.BidiTouchscreen(this);\n    }\n    #initialize() {\n      this.#frame.browsingContext.on('closed', () => {\n        this.trustedEmitter.emit(\"close\" /* PageEvent.Close */, undefined);\n        this.trustedEmitter.removeAllListeners();\n      });\n      this.trustedEmitter.on(\"workercreated\" /* PageEvent.WorkerCreated */, worker => {\n        this.#workers.add(worker);\n      });\n      this.trustedEmitter.on(\"workerdestroyed\" /* PageEvent.WorkerDestroyed */, worker => {\n        this.#workers.delete(worker);\n      });\n    }\n    /**\n     * @internal\n     */\n    _userAgentHeaders = {};\n    #userAgentInterception;\n    #userAgentPreloadScript;\n    async setUserAgent(userAgent, userAgentMetadata) {\n      if (!this.#browserContext.browser().cdpSupported && userAgentMetadata) {\n        throw new Errors_js_1.UnsupportedOperation('Current Browser does not support `userAgentMetadata`');\n      } else if (this.#browserContext.browser().cdpSupported && userAgentMetadata) {\n        return await this._client().send('Network.setUserAgentOverride', {\n          userAgent: userAgent,\n          userAgentMetadata: userAgentMetadata\n        });\n      }\n      const enable = userAgent !== '';\n      userAgent = userAgent ?? (await this.#browserContext.browser().userAgent());\n      this._userAgentHeaders = enable ? {\n        'User-Agent': userAgent\n      } : {};\n      this.#userAgentInterception = await this.#toggleInterception([\"beforeRequestSent\" /* Bidi.Network.InterceptPhase.BeforeRequestSent */], this.#userAgentInterception, enable);\n      const changeUserAgent = userAgent => {\n        Object.defineProperty(navigator, 'userAgent', {\n          value: userAgent\n        });\n      };\n      const frames = [this.#frame];\n      for (const frame of frames) {\n        frames.push(...frame.childFrames());\n      }\n      if (this.#userAgentPreloadScript) {\n        await this.removeScriptToEvaluateOnNewDocument(this.#userAgentPreloadScript);\n      }\n      const [evaluateToken] = await Promise.all([enable ? this.evaluateOnNewDocument(changeUserAgent, userAgent) : undefined,\n      // When we disable the UserAgent we want to\n      // evaluate the original value in all Browsing Contexts\n      frames.map(frame => {\n        return frame.evaluate(changeUserAgent, userAgent);\n      })]);\n      this.#userAgentPreloadScript = evaluateToken?.identifier;\n    }\n    async setBypassCSP(enabled) {\n      // TODO: handle CDP-specific cases such as mprach.\n      await this._client().send('Page.setBypassCSP', {\n        enabled\n      });\n    }\n    async queryObjects(prototypeHandle) {\n      (0, assert_js_1.assert)(!prototypeHandle.disposed, 'Prototype JSHandle is disposed!');\n      (0, assert_js_1.assert)(prototypeHandle.id, 'Prototype JSHandle must not be referencing primitive value');\n      const response = await this.#frame.client.send('Runtime.queryObjects', {\n        prototypeObjectId: prototypeHandle.id\n      });\n      return this.#frame.mainRealm().createHandle({\n        type: 'array',\n        handle: response.objects.objectId\n      });\n    }\n    browser() {\n      return this.browserContext().browser();\n    }\n    browserContext() {\n      return this.#browserContext;\n    }\n    mainFrame() {\n      return this.#frame;\n    }\n    async focusedFrame() {\n      const env_1 = {\n        stack: [],\n        error: void 0,\n        hasError: false\n      };\n      try {\n        const handle = __addDisposableResource(env_1, await this.mainFrame().isolatedRealm().evaluateHandle(() => {\n          let win = window;\n          while (win.document.activeElement instanceof win.HTMLIFrameElement || win.document.activeElement instanceof win.HTMLFrameElement) {\n            if (win.document.activeElement.contentWindow === null) {\n              break;\n            }\n            win = win.document.activeElement.contentWindow;\n          }\n          return win;\n        }), false);\n        const value = handle.remoteValue();\n        (0, assert_js_1.assert)(value.type === 'window');\n        const frame = this.frames().find(frame => {\n          return frame._id === value.value.context;\n        });\n        (0, assert_js_1.assert)(frame);\n        return frame;\n      } catch (e_1) {\n        env_1.error = e_1;\n        env_1.hasError = true;\n      } finally {\n        __disposeResources(env_1);\n      }\n    }\n    frames() {\n      const frames = [this.#frame];\n      for (const frame of frames) {\n        frames.push(...frame.childFrames());\n      }\n      return frames;\n    }\n    isClosed() {\n      return this.#frame.detached;\n    }\n    async close(options) {\n      const env_2 = {\n        stack: [],\n        error: void 0,\n        hasError: false\n      };\n      try {\n        const _guard = __addDisposableResource(env_2, await this.#browserContext.waitForScreenshotOperations(), false);\n        try {\n          await this.#frame.browsingContext.close(options?.runBeforeUnload);\n        } catch {\n          return;\n        }\n      } catch (e_2) {\n        env_2.error = e_2;\n        env_2.hasError = true;\n      } finally {\n        __disposeResources(env_2);\n      }\n    }\n    async reload(options = {}) {\n      const [response] = await Promise.all([this.#frame.waitForNavigation(options), this.#frame.browsingContext.reload()]).catch((0, util_js_2.rewriteNavigationError)(this.url(), options.timeout ?? this._timeoutSettings.navigationTimeout()));\n      return response;\n    }\n    setDefaultNavigationTimeout(timeout) {\n      this._timeoutSettings.setDefaultNavigationTimeout(timeout);\n    }\n    setDefaultTimeout(timeout) {\n      this._timeoutSettings.setDefaultTimeout(timeout);\n    }\n    getDefaultTimeout() {\n      return this._timeoutSettings.timeout();\n    }\n    isJavaScriptEnabled() {\n      return this.#cdpEmulationManager.javascriptEnabled;\n    }\n    async setGeolocation(options) {\n      return await this.#cdpEmulationManager.setGeolocation(options);\n    }\n    async setJavaScriptEnabled(enabled) {\n      return await this.#cdpEmulationManager.setJavaScriptEnabled(enabled);\n    }\n    async emulateMediaType(type) {\n      return await this.#cdpEmulationManager.emulateMediaType(type);\n    }\n    async emulateCPUThrottling(factor) {\n      return await this.#cdpEmulationManager.emulateCPUThrottling(factor);\n    }\n    async emulateMediaFeatures(features) {\n      return await this.#cdpEmulationManager.emulateMediaFeatures(features);\n    }\n    async emulateTimezone(timezoneId) {\n      return await this.#cdpEmulationManager.emulateTimezone(timezoneId);\n    }\n    async emulateIdleState(overrides) {\n      return await this.#cdpEmulationManager.emulateIdleState(overrides);\n    }\n    async emulateVisionDeficiency(type) {\n      return await this.#cdpEmulationManager.emulateVisionDeficiency(type);\n    }\n    async setViewport(viewport) {\n      if (!this.browser().cdpSupported) {\n        await this.#frame.browsingContext.setViewport({\n          viewport: viewport?.width && viewport?.height ? {\n            width: viewport.width,\n            height: viewport.height\n          } : null,\n          devicePixelRatio: viewport?.deviceScaleFactor ? viewport.deviceScaleFactor : null\n        });\n        this.#viewport = viewport;\n        return;\n      }\n      const needsReload = await this.#cdpEmulationManager.emulateViewport(viewport);\n      this.#viewport = viewport;\n      if (needsReload) {\n        await this.reload();\n      }\n    }\n    viewport() {\n      return this.#viewport;\n    }\n    async pdf(options = {}) {\n      const {\n        timeout: ms = this._timeoutSettings.timeout(),\n        path = undefined\n      } = options;\n      const {\n        printBackground: background,\n        margin,\n        landscape,\n        width,\n        height,\n        pageRanges: ranges,\n        scale,\n        preferCSSPageSize\n      } = (0, util_js_1.parsePDFOptions)(options, 'cm');\n      const pageRanges = ranges ? ranges.split(', ') : [];\n      await (0, rxjs_js_1.firstValueFrom)((0, rxjs_js_1.from)(this.mainFrame().isolatedRealm().evaluate(() => {\n        return document.fonts.ready;\n      })).pipe((0, rxjs_js_1.raceWith)((0, util_js_1.timeout)(ms))));\n      const data = await (0, rxjs_js_1.firstValueFrom)((0, rxjs_js_1.from)(this.#frame.browsingContext.print({\n        background,\n        margin,\n        orientation: landscape ? 'landscape' : 'portrait',\n        page: {\n          width,\n          height\n        },\n        pageRanges,\n        scale,\n        shrinkToFit: !preferCSSPageSize\n      })).pipe((0, rxjs_js_1.raceWith)((0, util_js_1.timeout)(ms))));\n      const typedArray = (0, encoding_js_1.stringToTypedArray)(data, true);\n      await this._maybeWriteTypedArrayToFile(path, typedArray);\n      return typedArray;\n    }\n    async createPDFStream(options) {\n      const typedArray = await this.pdf(options);\n      return new ReadableStream({\n        start(controller) {\n          controller.enqueue(typedArray);\n          controller.close();\n        }\n      });\n    }\n    async _screenshot(options) {\n      const {\n        clip,\n        type,\n        captureBeyondViewport,\n        quality\n      } = options;\n      if (options.omitBackground !== undefined && options.omitBackground) {\n        throw new Errors_js_1.UnsupportedOperation(`BiDi does not support 'omitBackground'.`);\n      }\n      if (options.optimizeForSpeed !== undefined && options.optimizeForSpeed) {\n        throw new Errors_js_1.UnsupportedOperation(`BiDi does not support 'optimizeForSpeed'.`);\n      }\n      if (options.fromSurface !== undefined && !options.fromSurface) {\n        throw new Errors_js_1.UnsupportedOperation(`BiDi does not support 'fromSurface'.`);\n      }\n      if (clip !== undefined && clip.scale !== undefined && clip.scale !== 1) {\n        throw new Errors_js_1.UnsupportedOperation(`BiDi does not support 'scale' in 'clip'.`);\n      }\n      let box;\n      if (clip) {\n        if (captureBeyondViewport) {\n          box = clip;\n        } else {\n          // The clip is always with respect to the document coordinates, so we\n          // need to convert this to viewport coordinates when we aren't capturing\n          // beyond the viewport.\n          const [pageLeft, pageTop] = await this.evaluate(() => {\n            if (!window.visualViewport) {\n              throw new Error('window.visualViewport is not supported.');\n            }\n            return [window.visualViewport.pageLeft, window.visualViewport.pageTop];\n          });\n          box = {\n            ...clip,\n            x: clip.x - pageLeft,\n            y: clip.y - pageTop\n          };\n        }\n      }\n      const data = await this.#frame.browsingContext.captureScreenshot({\n        origin: captureBeyondViewport ? 'document' : 'viewport',\n        format: {\n          type: `image/${type}`,\n          ...(quality !== undefined ? {\n            quality: quality / 100\n          } : {})\n        },\n        ...(box ? {\n          clip: {\n            type: 'box',\n            ...box\n          }\n        } : {})\n      });\n      return data;\n    }\n    async createCDPSession() {\n      return await this.#frame.createCDPSession();\n    }\n    async bringToFront() {\n      await this.#frame.browsingContext.activate();\n    }\n    async evaluateOnNewDocument(pageFunction, ...args) {\n      const expression = evaluationExpression(pageFunction, ...args);\n      const script = await this.#frame.browsingContext.addPreloadScript(expression);\n      return {\n        identifier: script\n      };\n    }\n    async removeScriptToEvaluateOnNewDocument(id) {\n      await this.#frame.browsingContext.removePreloadScript(id);\n    }\n    async exposeFunction(name, pptrFunction) {\n      return await this.mainFrame().exposeFunction(name, 'default' in pptrFunction ? pptrFunction.default : pptrFunction);\n    }\n    isDragInterceptionEnabled() {\n      return false;\n    }\n    async setCacheEnabled(enabled) {\n      if (!this.#browserContext.browser().cdpSupported) {\n        await this.#frame.browsingContext.setCacheBehavior(enabled ? 'default' : 'bypass');\n        return;\n      }\n      // TODO: handle CDP-specific cases such as mprach.\n      await this._client().send('Network.setCacheDisabled', {\n        cacheDisabled: !enabled\n      });\n    }\n    async cookies(...urls) {\n      const normalizedUrls = (urls.length ? urls : [this.url()]).map(url => {\n        return new URL(url);\n      });\n      const cookies = await this.#frame.browsingContext.getCookies();\n      return cookies.map(cookie => {\n        return bidiToPuppeteerCookie(cookie);\n      }).filter(cookie => {\n        return normalizedUrls.some(url => {\n          return testUrlMatchCookie(cookie, url);\n        });\n      });\n    }\n    isServiceWorkerBypassed() {\n      throw new Errors_js_1.UnsupportedOperation();\n    }\n    target() {\n      throw new Errors_js_1.UnsupportedOperation();\n    }\n    waitForFileChooser() {\n      throw new Errors_js_1.UnsupportedOperation();\n    }\n    workers() {\n      return [...this.#workers];\n    }\n    #userInterception;\n    async setRequestInterception(enable) {\n      this.#userInterception = await this.#toggleInterception([\"beforeRequestSent\" /* Bidi.Network.InterceptPhase.BeforeRequestSent */], this.#userInterception, enable);\n    }\n    /**\n     * @internal\n     */\n    _extraHTTPHeaders = {};\n    #extraHeadersInterception;\n    async setExtraHTTPHeaders(headers) {\n      const extraHTTPHeaders = {};\n      for (const [key, value] of Object.entries(headers)) {\n        (0, assert_js_1.assert)((0, util_js_1.isString)(value), `Expected value of header \"${key}\" to be String, but \"${typeof value}\" is found.`);\n        extraHTTPHeaders[key.toLowerCase()] = value;\n      }\n      this._extraHTTPHeaders = extraHTTPHeaders;\n      this.#extraHeadersInterception = await this.#toggleInterception([\"beforeRequestSent\" /* Bidi.Network.InterceptPhase.BeforeRequestSent */], this.#extraHeadersInterception, Boolean(Object.keys(this._extraHTTPHeaders).length));\n    }\n    /**\n     * @internal\n     */\n    _credentials = null;\n    #authInterception;\n    async authenticate(credentials) {\n      this.#authInterception = await this.#toggleInterception([\"authRequired\" /* Bidi.Network.InterceptPhase.AuthRequired */], this.#authInterception, Boolean(credentials));\n      this._credentials = credentials;\n    }\n    async #toggleInterception(phases, interception, expected) {\n      if (expected && !interception) {\n        return await this.#frame.browsingContext.addIntercept({\n          phases\n        });\n      } else if (!expected && interception) {\n        await this.#frame.browsingContext.userContext.browser.removeIntercept(interception);\n        return;\n      }\n      return interception;\n    }\n    setDragInterception() {\n      throw new Errors_js_1.UnsupportedOperation();\n    }\n    setBypassServiceWorker() {\n      throw new Errors_js_1.UnsupportedOperation();\n    }\n    async setOfflineMode(enabled) {\n      if (!this.#browserContext.browser().cdpSupported) {\n        throw new Errors_js_1.UnsupportedOperation();\n      }\n      if (!this.#emulatedNetworkConditions) {\n        this.#emulatedNetworkConditions = {\n          offline: false,\n          upload: -1,\n          download: -1,\n          latency: 0\n        };\n      }\n      this.#emulatedNetworkConditions.offline = enabled;\n      return await this.#applyNetworkConditions();\n    }\n    async emulateNetworkConditions(networkConditions) {\n      if (!this.#browserContext.browser().cdpSupported) {\n        throw new Errors_js_1.UnsupportedOperation();\n      }\n      if (!this.#emulatedNetworkConditions) {\n        this.#emulatedNetworkConditions = {\n          offline: false,\n          upload: -1,\n          download: -1,\n          latency: 0\n        };\n      }\n      this.#emulatedNetworkConditions.upload = networkConditions ? networkConditions.upload : -1;\n      this.#emulatedNetworkConditions.download = networkConditions ? networkConditions.download : -1;\n      this.#emulatedNetworkConditions.latency = networkConditions ? networkConditions.latency : 0;\n      return await this.#applyNetworkConditions();\n    }\n    async #applyNetworkConditions() {\n      if (!this.#emulatedNetworkConditions) {\n        return;\n      }\n      await this._client().send('Network.emulateNetworkConditions', {\n        offline: this.#emulatedNetworkConditions.offline,\n        latency: this.#emulatedNetworkConditions.latency,\n        uploadThroughput: this.#emulatedNetworkConditions.upload,\n        downloadThroughput: this.#emulatedNetworkConditions.download\n      });\n    }\n    async setCookie(...cookies) {\n      const pageURL = this.url();\n      const pageUrlStartsWithHTTP = pageURL.startsWith('http');\n      for (const cookie of cookies) {\n        let cookieUrl = cookie.url || '';\n        if (!cookieUrl && pageUrlStartsWithHTTP) {\n          cookieUrl = pageURL;\n        }\n        (0, assert_js_1.assert)(cookieUrl !== 'about:blank', `Blank page can not have cookie \"${cookie.name}\"`);\n        (0, assert_js_1.assert)(!String.prototype.startsWith.call(cookieUrl || '', 'data:'), `Data URL page can not have cookie \"${cookie.name}\"`);\n        const normalizedUrl = URL.canParse(cookieUrl) ? new URL(cookieUrl) : undefined;\n        const domain = cookie.domain ?? normalizedUrl?.hostname;\n        (0, assert_js_1.assert)(domain !== undefined, `At least one of the url and domain needs to be specified`);\n        const bidiCookie = {\n          domain: domain,\n          name: cookie.name,\n          value: {\n            type: 'string',\n            value: cookie.value\n          },\n          ...(cookie.path !== undefined ? {\n            path: cookie.path\n          } : {}),\n          ...(cookie.httpOnly !== undefined ? {\n            httpOnly: cookie.httpOnly\n          } : {}),\n          ...(cookie.secure !== undefined ? {\n            secure: cookie.secure\n          } : {}),\n          ...(cookie.sameSite !== undefined ? {\n            sameSite: convertCookiesSameSiteCdpToBiDi(cookie.sameSite)\n          } : {}),\n          ...(cookie.expires !== undefined ? {\n            expiry: cookie.expires\n          } : {}),\n          // Chrome-specific properties.\n          ...cdpSpecificCookiePropertiesFromPuppeteerToBidi(cookie, 'sameParty', 'sourceScheme', 'priority', 'url')\n        };\n        if (cookie.partitionKey !== undefined) {\n          await this.browserContext().userContext.setCookie(bidiCookie, cookie.partitionKey);\n        } else {\n          await this.#frame.browsingContext.setCookie(bidiCookie);\n        }\n      }\n    }\n    async deleteCookie(...cookies) {\n      await Promise.all(cookies.map(async deleteCookieRequest => {\n        const cookieUrl = deleteCookieRequest.url ?? this.url();\n        const normalizedUrl = URL.canParse(cookieUrl) ? new URL(cookieUrl) : undefined;\n        const domain = deleteCookieRequest.domain ?? normalizedUrl?.hostname;\n        (0, assert_js_1.assert)(domain !== undefined, `At least one of the url and domain needs to be specified`);\n        const filter = {\n          domain: domain,\n          name: deleteCookieRequest.name,\n          ...(deleteCookieRequest.path !== undefined ? {\n            path: deleteCookieRequest.path\n          } : {})\n        };\n        await this.#frame.browsingContext.deleteCookie(filter);\n      }));\n    }\n    async removeExposedFunction(name) {\n      await this.#frame.removeExposedFunction(name);\n    }\n    metrics() {\n      throw new Errors_js_1.UnsupportedOperation();\n    }\n    async goBack(options = {}) {\n      return await this.#go(-1, options);\n    }\n    async goForward(options = {}) {\n      return await this.#go(1, options);\n    }\n    async #go(delta, options) {\n      const controller = new AbortController();\n      try {\n        const [response] = await Promise.all([this.waitForNavigation({\n          ...options,\n          signal: controller.signal\n        }), this.#frame.browsingContext.traverseHistory(delta)]);\n        return response;\n      } catch (error) {\n        controller.abort();\n        if ((0, ErrorLike_js_1.isErrorLike)(error)) {\n          if (error.message.includes('no such history entry')) {\n            return null;\n          }\n        }\n        throw error;\n      }\n    }\n    waitForDevicePrompt() {\n      throw new Errors_js_1.UnsupportedOperation();\n    }\n  };\n})();\nexports.BidiPage = BidiPage;\nfunction evaluationExpression(fun, ...args) {\n  return `() => {${(0, util_js_1.evaluationString)(fun, ...args)}}`;\n}\n/**\n * Check domains match.\n * According to cookies spec, this check should match subdomains as well, but CDP\n * implementation does not do that, so this method matches only the exact domains, not\n * what is written in the spec:\n * https://datatracker.ietf.org/doc/html/rfc6265#section-5.1.3\n */\nfunction testUrlMatchCookieHostname(cookie, normalizedUrl) {\n  const cookieDomain = cookie.domain.toLowerCase();\n  const urlHostname = normalizedUrl.hostname.toLowerCase();\n  return cookieDomain === urlHostname;\n}\n/**\n * Check paths match.\n * Spec: https://datatracker.ietf.org/doc/html/rfc6265#section-5.1.4\n */\nfunction testUrlMatchCookiePath(cookie, normalizedUrl) {\n  const uriPath = normalizedUrl.pathname;\n  const cookiePath = cookie.path;\n  if (uriPath === cookiePath) {\n    // The cookie-path and the request-path are identical.\n    return true;\n  }\n  if (uriPath.startsWith(cookiePath)) {\n    // The cookie-path is a prefix of the request-path.\n    if (cookiePath.endsWith('/')) {\n      // The last character of the cookie-path is %x2F (\"/\").\n      return true;\n    }\n    if (uriPath[cookiePath.length] === '/') {\n      // The first character of the request-path that is not included in the cookie-path\n      // is a %x2F (\"/\") character.\n      return true;\n    }\n  }\n  return false;\n}\n/**\n * Checks the cookie matches the URL according to the spec:\n */\nfunction testUrlMatchCookie(cookie, url) {\n  const normalizedUrl = new URL(url);\n  (0, assert_js_1.assert)(cookie !== undefined);\n  if (!testUrlMatchCookieHostname(cookie, normalizedUrl)) {\n    return false;\n  }\n  return testUrlMatchCookiePath(cookie, normalizedUrl);\n}\nfunction bidiToPuppeteerCookie(bidiCookie) {\n  const partitionKey = bidiCookie[CDP_SPECIFIC_PREFIX + 'partitionKey'];\n  function getParitionKey() {\n    if (typeof partitionKey === 'string') {\n      return {\n        partitionKey\n      };\n    }\n    if (typeof partitionKey === 'object' && partitionKey !== null) {\n      return {\n        // TODO: a breaking change in Puppeteer is required to change\n        // partitionKey type and report the composite partition key.\n        partitionKey: partitionKey.topLevelSite\n      };\n    }\n    return {};\n  }\n  return {\n    name: bidiCookie.name,\n    // Presents binary value as base64 string.\n    value: bidiCookie.value.value,\n    domain: bidiCookie.domain,\n    path: bidiCookie.path,\n    size: bidiCookie.size,\n    httpOnly: bidiCookie.httpOnly,\n    secure: bidiCookie.secure,\n    sameSite: convertCookiesSameSiteBiDiToCdp(bidiCookie.sameSite),\n    expires: bidiCookie.expiry ?? -1,\n    session: bidiCookie.expiry === undefined || bidiCookie.expiry <= 0,\n    // Extending with CDP-specific properties with `goog:` prefix.\n    ...cdpSpecificCookiePropertiesFromBidiToPuppeteer(bidiCookie, 'sameParty', 'sourceScheme', 'partitionKeyOpaque', 'priority'),\n    ...getParitionKey()\n  };\n}\nconst CDP_SPECIFIC_PREFIX = 'goog:';\n/**\n * Gets CDP-specific properties from the BiDi cookie and returns them as a new object.\n */\nfunction cdpSpecificCookiePropertiesFromBidiToPuppeteer(bidiCookie, ...propertyNames) {\n  const result = {};\n  for (const property of propertyNames) {\n    if (bidiCookie[CDP_SPECIFIC_PREFIX + property] !== undefined) {\n      result[property] = bidiCookie[CDP_SPECIFIC_PREFIX + property];\n    }\n  }\n  return result;\n}\n/**\n * Gets CDP-specific properties from the cookie, adds CDP-specific prefixes and returns\n * them as a new object which can be used in BiDi.\n */\nfunction cdpSpecificCookiePropertiesFromPuppeteerToBidi(cookieParam, ...propertyNames) {\n  const result = {};\n  for (const property of propertyNames) {\n    if (cookieParam[property] !== undefined) {\n      result[CDP_SPECIFIC_PREFIX + property] = cookieParam[property];\n    }\n  }\n  return result;\n}\nfunction convertCookiesSameSiteBiDiToCdp(sameSite) {\n  return sameSite === 'strict' ? 'Strict' : sameSite === 'lax' ? 'Lax' : 'None';\n}\nfunction convertCookiesSameSiteCdpToBiDi(sameSite) {\n  return sameSite === 'Strict' ? \"strict\" /* Bidi.Network.SameSite.Strict */ : sameSite === 'Lax' ? \"lax\" /* Bidi.Network.SameSite.Lax */ : \"none\" /* Bidi.Network.SameSite.None */;\n}","map":{"version":3,"names":["rxjs_js_1","require","Page_js_1","Coverage_js_1","EmulationManager_js_1","Tracing_js_1","Errors_js_1","EventEmitter_js_1","util_js_1","assert_js_1","decorators_js_1","encoding_js_1","ErrorLike_js_1","Frame_js_1","Input_js_1","util_js_2","BidiPage","Page","_classSuper","bubble","__esDecorate","_trustedEmitter_decorators","kind","name","static","private","access","has","obj","get","trustedEmitter","set","value","metadata","_metadata","_trustedEmitter_initializers","_trustedEmitter_extraInitializers","from","browserContext","browsingContext","page","initialize","trustedEmitter_accessor_storage","__runInitializers","EventEmitter","frame","viewport","workers","Set","keyboard","mouse","touchscreen","tracing","coverage","cdpEmulationManager","emulatedNetworkConditions","_client","client","constructor","BidiFrame","EmulationManager","Tracing","Coverage","BidiKeyboard","BidiMouse","BidiTouchscreen","#initialize","on","emit","undefined","removeAllListeners","worker","add","delete","_userAgentHeaders","userAgentInterception","userAgentPreloadScript","setUserAgent","userAgent","userAgentMetadata","browser","cdpSupported","UnsupportedOperation","send","enable","toggleInterception","changeUserAgent","Object","defineProperty","navigator","frames","push","childFrames","removeScriptToEvaluateOnNewDocument","evaluateToken","Promise","all","evaluateOnNewDocument","map","evaluate","identifier","setBypassCSP","enabled","queryObjects","prototypeHandle","assert","disposed","id","response","prototypeObjectId","mainRealm","createHandle","type","handle","objects","objectId","mainFrame","focusedFrame","__addDisposableResource","env_1","isolatedRealm","evaluateHandle","win","window","document","activeElement","HTMLIFrameElement","HTMLFrameElement","contentWindow","remoteValue","find","_id","context","isClosed","detached","close","options","_guard","env_2","waitForScreenshotOperations","runBeforeUnload","reload","waitForNavigation","catch","rewriteNavigationError","url","timeout","_timeoutSettings","navigationTimeout","setDefaultNavigationTimeout","setDefaultTimeout","getDefaultTimeout","isJavaScriptEnabled","javascriptEnabled","setGeolocation","setJavaScriptEnabled","emulateMediaType","emulateCPUThrottling","factor","emulateMediaFeatures","features","emulateTimezone","timezoneId","emulateIdleState","overrides","emulateVisionDeficiency","setViewport","width","height","devicePixelRatio","deviceScaleFactor","needsReload","emulateViewport","pdf","ms","path","printBackground","background","margin","landscape","pageRanges","ranges","scale","preferCSSPageSize","parsePDFOptions","split","firstValueFrom","fonts","ready","pipe","raceWith","data","print","orientation","shrinkToFit","typedArray","stringToTypedArray","_maybeWriteTypedArrayToFile","createPDFStream","ReadableStream","start","controller","enqueue","_screenshot","clip","captureBeyondViewport","quality","omitBackground","optimizeForSpeed","fromSurface","box","pageLeft","pageTop","visualViewport","Error","x","y","captureScreenshot","origin","format","createCDPSession","bringToFront","activate","pageFunction","args","expression","evaluationExpression","script","addPreloadScript","removePreloadScript","exposeFunction","pptrFunction","default","isDragInterceptionEnabled","setCacheEnabled","setCacheBehavior","cacheDisabled","cookies","urls","normalizedUrls","length","URL","getCookies","cookie","bidiToPuppeteerCookie","filter","some","testUrlMatchCookie","isServiceWorkerBypassed","target","waitForFileChooser","userInterception","setRequestInterception","_extraHTTPHeaders","extraHeadersInterception","setExtraHTTPHeaders","headers","extraHTTPHeaders","key","entries","isString","toLowerCase","Boolean","keys","_credentials","authInterception","authenticate","credentials","#toggleInterception","phases","interception","expected","addIntercept","userContext","removeIntercept","setDragInterception","setBypassServiceWorker","setOfflineMode","offline","upload","download","latency","applyNetworkConditions","emulateNetworkConditions","networkConditions","#applyNetworkConditions","uploadThroughput","downloadThroughput","setCookie","pageURL","pageUrlStartsWithHTTP","startsWith","cookieUrl","String","prototype","call","normalizedUrl","canParse","domain","hostname","bidiCookie","httpOnly","secure","sameSite","convertCookiesSameSiteCdpToBiDi","expires","expiry","cdpSpecificCookiePropertiesFromPuppeteerToBidi","partitionKey","deleteCookie","deleteCookieRequest","removeExposedFunction","metrics","goBack","go","goForward","#go","delta","AbortController","signal","traverseHistory","error","abort","isErrorLike","message","includes","waitForDevicePrompt","exports","fun","evaluationString","testUrlMatchCookieHostname","cookieDomain","urlHostname","testUrlMatchCookiePath","uriPath","pathname","cookiePath","endsWith","CDP_SPECIFIC_PREFIX","getParitionKey","topLevelSite","size","convertCookiesSameSiteBiDiToCdp","session","cdpSpecificCookiePropertiesFromBidiToPuppeteer","propertyNames","result","property","cookieParam"],"sources":["/Users/lawj4/webDevelopment/node_modules/puppeteer-core/src/bidi/Page.ts"],"sourcesContent":["/**\n * @license\n * Copyright 2022 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as Bidi from 'chromium-bidi/lib/cjs/protocol/protocol.js';\nimport type Protocol from 'devtools-protocol';\n\nimport {firstValueFrom, from, raceWith} from '../../third_party/rxjs/rxjs.js';\nimport type {CDPSession} from '../api/CDPSession.js';\nimport type {BoundingBox} from '../api/ElementHandle.js';\nimport type {WaitForOptions} from '../api/Frame.js';\nimport type {HTTPResponse} from '../api/HTTPResponse.js';\nimport type {\n  Credentials,\n  GeolocationOptions,\n  MediaFeature,\n  PageEvents,\n} from '../api/Page.js';\nimport {\n  Page,\n  PageEvent,\n  type NewDocumentScriptEvaluation,\n  type ScreenshotOptions,\n} from '../api/Page.js';\nimport {Coverage} from '../cdp/Coverage.js';\nimport {EmulationManager} from '../cdp/EmulationManager.js';\nimport type {\n  InternalNetworkConditions,\n  NetworkConditions,\n} from '../cdp/NetworkManager.js';\nimport {Tracing} from '../cdp/Tracing.js';\nimport type {\n  Cookie,\n  CookieParam,\n  CookieSameSite,\n  DeleteCookiesRequest,\n} from '../common/Cookie.js';\nimport {UnsupportedOperation} from '../common/Errors.js';\nimport {EventEmitter} from '../common/EventEmitter.js';\nimport type {PDFOptions} from '../common/PDFOptions.js';\nimport type {Awaitable} from '../common/types.js';\nimport {\n  evaluationString,\n  isString,\n  parsePDFOptions,\n  timeout,\n} from '../common/util.js';\nimport type {Viewport} from '../common/Viewport.js';\nimport {assert} from '../util/assert.js';\nimport {bubble} from '../util/decorators.js';\nimport {stringToTypedArray} from '../util/encoding.js';\nimport {isErrorLike} from '../util/ErrorLike.js';\n\nimport type {BidiBrowser} from './Browser.js';\nimport type {BidiBrowserContext} from './BrowserContext.js';\nimport type {BidiCdpSession} from './CDPSession.js';\nimport type {BrowsingContext} from './core/BrowsingContext.js';\nimport {BidiFrame} from './Frame.js';\nimport type {BidiHTTPResponse} from './HTTPResponse.js';\nimport {BidiKeyboard, BidiMouse, BidiTouchscreen} from './Input.js';\nimport type {BidiJSHandle} from './JSHandle.js';\nimport {rewriteNavigationError} from './util.js';\nimport type {BidiWebWorker} from './WebWorker.js';\n\n/**\n * Implements Page using WebDriver BiDi.\n *\n * @internal\n */\nexport class BidiPage extends Page {\n  static from(\n    browserContext: BidiBrowserContext,\n    browsingContext: BrowsingContext\n  ): BidiPage {\n    const page = new BidiPage(browserContext, browsingContext);\n    page.#initialize();\n    return page;\n  }\n\n  @bubble()\n  accessor trustedEmitter = new EventEmitter<PageEvents>();\n\n  readonly #browserContext: BidiBrowserContext;\n  readonly #frame: BidiFrame;\n  #viewport: Viewport | null = null;\n  readonly #workers = new Set<BidiWebWorker>();\n\n  readonly keyboard: BidiKeyboard;\n  readonly mouse: BidiMouse;\n  readonly touchscreen: BidiTouchscreen;\n  readonly tracing: Tracing;\n  readonly coverage: Coverage;\n  readonly #cdpEmulationManager: EmulationManager;\n\n  #emulatedNetworkConditions?: InternalNetworkConditions;\n\n  _client(): BidiCdpSession {\n    return this.#frame.client;\n  }\n\n  private constructor(\n    browserContext: BidiBrowserContext,\n    browsingContext: BrowsingContext\n  ) {\n    super();\n    this.#browserContext = browserContext;\n    this.#frame = BidiFrame.from(this, browsingContext);\n\n    this.#cdpEmulationManager = new EmulationManager(this.#frame.client);\n    this.tracing = new Tracing(this.#frame.client);\n    this.coverage = new Coverage(this.#frame.client);\n    this.keyboard = new BidiKeyboard(this);\n    this.mouse = new BidiMouse(this);\n    this.touchscreen = new BidiTouchscreen(this);\n  }\n\n  #initialize() {\n    this.#frame.browsingContext.on('closed', () => {\n      this.trustedEmitter.emit(PageEvent.Close, undefined);\n      this.trustedEmitter.removeAllListeners();\n    });\n\n    this.trustedEmitter.on(PageEvent.WorkerCreated, worker => {\n      this.#workers.add(worker as BidiWebWorker);\n    });\n    this.trustedEmitter.on(PageEvent.WorkerDestroyed, worker => {\n      this.#workers.delete(worker as BidiWebWorker);\n    });\n  }\n  /**\n   * @internal\n   */\n  _userAgentHeaders: Record<string, string> = {};\n  #userAgentInterception?: string;\n  #userAgentPreloadScript?: string;\n  override async setUserAgent(\n    userAgent: string,\n    userAgentMetadata?: Protocol.Emulation.UserAgentMetadata\n  ): Promise<void> {\n    if (!this.#browserContext.browser().cdpSupported && userAgentMetadata) {\n      throw new UnsupportedOperation(\n        'Current Browser does not support `userAgentMetadata`'\n      );\n    } else if (\n      this.#browserContext.browser().cdpSupported &&\n      userAgentMetadata\n    ) {\n      return await this._client().send('Network.setUserAgentOverride', {\n        userAgent: userAgent,\n        userAgentMetadata: userAgentMetadata,\n      });\n    }\n    const enable = userAgent !== '';\n    userAgent = userAgent ?? (await this.#browserContext.browser().userAgent());\n\n    this._userAgentHeaders = enable\n      ? {\n          'User-Agent': userAgent,\n        }\n      : {};\n\n    this.#userAgentInterception = await this.#toggleInterception(\n      [Bidi.Network.InterceptPhase.BeforeRequestSent],\n      this.#userAgentInterception,\n      enable\n    );\n\n    const changeUserAgent = (userAgent: string) => {\n      Object.defineProperty(navigator, 'userAgent', {\n        value: userAgent,\n      });\n    };\n\n    const frames = [this.#frame];\n    for (const frame of frames) {\n      frames.push(...frame.childFrames());\n    }\n\n    if (this.#userAgentPreloadScript) {\n      await this.removeScriptToEvaluateOnNewDocument(\n        this.#userAgentPreloadScript\n      );\n    }\n    const [evaluateToken] = await Promise.all([\n      enable\n        ? this.evaluateOnNewDocument(changeUserAgent, userAgent)\n        : undefined,\n      // When we disable the UserAgent we want to\n      // evaluate the original value in all Browsing Contexts\n      frames.map(frame => {\n        return frame.evaluate(changeUserAgent, userAgent);\n      }),\n    ]);\n    this.#userAgentPreloadScript = evaluateToken?.identifier;\n  }\n\n  override async setBypassCSP(enabled: boolean): Promise<void> {\n    // TODO: handle CDP-specific cases such as mprach.\n    await this._client().send('Page.setBypassCSP', {enabled});\n  }\n\n  override async queryObjects<Prototype>(\n    prototypeHandle: BidiJSHandle<Prototype>\n  ): Promise<BidiJSHandle<Prototype[]>> {\n    assert(!prototypeHandle.disposed, 'Prototype JSHandle is disposed!');\n    assert(\n      prototypeHandle.id,\n      'Prototype JSHandle must not be referencing primitive value'\n    );\n    const response = await this.#frame.client.send('Runtime.queryObjects', {\n      prototypeObjectId: prototypeHandle.id,\n    });\n    return this.#frame.mainRealm().createHandle({\n      type: 'array',\n      handle: response.objects.objectId,\n    }) as BidiJSHandle<Prototype[]>;\n  }\n\n  override browser(): BidiBrowser {\n    return this.browserContext().browser();\n  }\n\n  override browserContext(): BidiBrowserContext {\n    return this.#browserContext;\n  }\n\n  override mainFrame(): BidiFrame {\n    return this.#frame;\n  }\n\n  async focusedFrame(): Promise<BidiFrame> {\n    using handle = (await this.mainFrame()\n      .isolatedRealm()\n      .evaluateHandle(() => {\n        let win = window;\n        while (\n          win.document.activeElement instanceof win.HTMLIFrameElement ||\n          win.document.activeElement instanceof win.HTMLFrameElement\n        ) {\n          if (win.document.activeElement.contentWindow === null) {\n            break;\n          }\n          win = win.document.activeElement.contentWindow as typeof win;\n        }\n        return win;\n      })) as BidiJSHandle<Window & typeof globalThis>;\n    const value = handle.remoteValue();\n    assert(value.type === 'window');\n    const frame = this.frames().find(frame => {\n      return frame._id === value.value.context;\n    });\n    assert(frame);\n    return frame;\n  }\n\n  override frames(): BidiFrame[] {\n    const frames = [this.#frame];\n    for (const frame of frames) {\n      frames.push(...frame.childFrames());\n    }\n    return frames;\n  }\n\n  override isClosed(): boolean {\n    return this.#frame.detached;\n  }\n\n  override async close(options?: {runBeforeUnload?: boolean}): Promise<void> {\n    using _guard = await this.#browserContext.waitForScreenshotOperations();\n    try {\n      await this.#frame.browsingContext.close(options?.runBeforeUnload);\n    } catch {\n      return;\n    }\n  }\n\n  override async reload(\n    options: WaitForOptions = {}\n  ): Promise<BidiHTTPResponse | null> {\n    const [response] = await Promise.all([\n      this.#frame.waitForNavigation(options),\n      this.#frame.browsingContext.reload(),\n    ]).catch(\n      rewriteNavigationError(\n        this.url(),\n        options.timeout ?? this._timeoutSettings.navigationTimeout()\n      )\n    );\n    return response;\n  }\n\n  override setDefaultNavigationTimeout(timeout: number): void {\n    this._timeoutSettings.setDefaultNavigationTimeout(timeout);\n  }\n\n  override setDefaultTimeout(timeout: number): void {\n    this._timeoutSettings.setDefaultTimeout(timeout);\n  }\n\n  override getDefaultTimeout(): number {\n    return this._timeoutSettings.timeout();\n  }\n\n  override isJavaScriptEnabled(): boolean {\n    return this.#cdpEmulationManager.javascriptEnabled;\n  }\n\n  override async setGeolocation(options: GeolocationOptions): Promise<void> {\n    return await this.#cdpEmulationManager.setGeolocation(options);\n  }\n\n  override async setJavaScriptEnabled(enabled: boolean): Promise<void> {\n    return await this.#cdpEmulationManager.setJavaScriptEnabled(enabled);\n  }\n\n  override async emulateMediaType(type?: string): Promise<void> {\n    return await this.#cdpEmulationManager.emulateMediaType(type);\n  }\n\n  override async emulateCPUThrottling(factor: number | null): Promise<void> {\n    return await this.#cdpEmulationManager.emulateCPUThrottling(factor);\n  }\n\n  override async emulateMediaFeatures(\n    features?: MediaFeature[]\n  ): Promise<void> {\n    return await this.#cdpEmulationManager.emulateMediaFeatures(features);\n  }\n\n  override async emulateTimezone(timezoneId?: string): Promise<void> {\n    return await this.#cdpEmulationManager.emulateTimezone(timezoneId);\n  }\n\n  override async emulateIdleState(overrides?: {\n    isUserActive: boolean;\n    isScreenUnlocked: boolean;\n  }): Promise<void> {\n    return await this.#cdpEmulationManager.emulateIdleState(overrides);\n  }\n\n  override async emulateVisionDeficiency(\n    type?: Protocol.Emulation.SetEmulatedVisionDeficiencyRequest['type']\n  ): Promise<void> {\n    return await this.#cdpEmulationManager.emulateVisionDeficiency(type);\n  }\n\n  override async setViewport(viewport: Viewport | null): Promise<void> {\n    if (!this.browser().cdpSupported) {\n      await this.#frame.browsingContext.setViewport({\n        viewport:\n          viewport?.width && viewport?.height\n            ? {\n                width: viewport.width,\n                height: viewport.height,\n              }\n            : null,\n        devicePixelRatio: viewport?.deviceScaleFactor\n          ? viewport.deviceScaleFactor\n          : null,\n      });\n      this.#viewport = viewport;\n      return;\n    }\n    const needsReload =\n      await this.#cdpEmulationManager.emulateViewport(viewport);\n    this.#viewport = viewport;\n    if (needsReload) {\n      await this.reload();\n    }\n  }\n\n  override viewport(): Viewport | null {\n    return this.#viewport;\n  }\n\n  override async pdf(options: PDFOptions = {}): Promise<Uint8Array> {\n    const {timeout: ms = this._timeoutSettings.timeout(), path = undefined} =\n      options;\n    const {\n      printBackground: background,\n      margin,\n      landscape,\n      width,\n      height,\n      pageRanges: ranges,\n      scale,\n      preferCSSPageSize,\n    } = parsePDFOptions(options, 'cm');\n    const pageRanges = ranges ? ranges.split(', ') : [];\n\n    await firstValueFrom(\n      from(\n        this.mainFrame()\n          .isolatedRealm()\n          .evaluate(() => {\n            return document.fonts.ready;\n          })\n      ).pipe(raceWith(timeout(ms)))\n    );\n\n    const data = await firstValueFrom(\n      from(\n        this.#frame.browsingContext.print({\n          background,\n          margin,\n          orientation: landscape ? 'landscape' : 'portrait',\n          page: {\n            width,\n            height,\n          },\n          pageRanges,\n          scale,\n          shrinkToFit: !preferCSSPageSize,\n        })\n      ).pipe(raceWith(timeout(ms)))\n    );\n\n    const typedArray = stringToTypedArray(data, true);\n\n    await this._maybeWriteTypedArrayToFile(path, typedArray);\n\n    return typedArray;\n  }\n\n  override async createPDFStream(\n    options?: PDFOptions | undefined\n  ): Promise<ReadableStream<Uint8Array>> {\n    const typedArray = await this.pdf(options);\n\n    return new ReadableStream({\n      start(controller) {\n        controller.enqueue(typedArray);\n        controller.close();\n      },\n    });\n  }\n\n  override async _screenshot(\n    options: Readonly<ScreenshotOptions>\n  ): Promise<string> {\n    const {clip, type, captureBeyondViewport, quality} = options;\n    if (options.omitBackground !== undefined && options.omitBackground) {\n      throw new UnsupportedOperation(`BiDi does not support 'omitBackground'.`);\n    }\n    if (options.optimizeForSpeed !== undefined && options.optimizeForSpeed) {\n      throw new UnsupportedOperation(\n        `BiDi does not support 'optimizeForSpeed'.`\n      );\n    }\n    if (options.fromSurface !== undefined && !options.fromSurface) {\n      throw new UnsupportedOperation(`BiDi does not support 'fromSurface'.`);\n    }\n    if (clip !== undefined && clip.scale !== undefined && clip.scale !== 1) {\n      throw new UnsupportedOperation(\n        `BiDi does not support 'scale' in 'clip'.`\n      );\n    }\n\n    let box: BoundingBox | undefined;\n    if (clip) {\n      if (captureBeyondViewport) {\n        box = clip;\n      } else {\n        // The clip is always with respect to the document coordinates, so we\n        // need to convert this to viewport coordinates when we aren't capturing\n        // beyond the viewport.\n        const [pageLeft, pageTop] = await this.evaluate(() => {\n          if (!window.visualViewport) {\n            throw new Error('window.visualViewport is not supported.');\n          }\n          return [\n            window.visualViewport.pageLeft,\n            window.visualViewport.pageTop,\n          ] as const;\n        });\n        box = {\n          ...clip,\n          x: clip.x - pageLeft,\n          y: clip.y - pageTop,\n        };\n      }\n    }\n\n    const data = await this.#frame.browsingContext.captureScreenshot({\n      origin: captureBeyondViewport ? 'document' : 'viewport',\n      format: {\n        type: `image/${type}`,\n        ...(quality !== undefined ? {quality: quality / 100} : {}),\n      },\n      ...(box ? {clip: {type: 'box', ...box}} : {}),\n    });\n    return data;\n  }\n\n  override async createCDPSession(): Promise<CDPSession> {\n    return await this.#frame.createCDPSession();\n  }\n\n  override async bringToFront(): Promise<void> {\n    await this.#frame.browsingContext.activate();\n  }\n\n  override async evaluateOnNewDocument<\n    Params extends unknown[],\n    Func extends (...args: Params) => unknown = (...args: Params) => unknown,\n  >(\n    pageFunction: Func | string,\n    ...args: Params\n  ): Promise<NewDocumentScriptEvaluation> {\n    const expression = evaluationExpression(pageFunction, ...args);\n    const script =\n      await this.#frame.browsingContext.addPreloadScript(expression);\n\n    return {identifier: script};\n  }\n\n  override async removeScriptToEvaluateOnNewDocument(\n    id: string\n  ): Promise<void> {\n    await this.#frame.browsingContext.removePreloadScript(id);\n  }\n\n  override async exposeFunction<Args extends unknown[], Ret>(\n    name: string,\n    pptrFunction:\n      | ((...args: Args) => Awaitable<Ret>)\n      | {default: (...args: Args) => Awaitable<Ret>}\n  ): Promise<void> {\n    return await this.mainFrame().exposeFunction(\n      name,\n      'default' in pptrFunction ? pptrFunction.default : pptrFunction\n    );\n  }\n\n  override isDragInterceptionEnabled(): boolean {\n    return false;\n  }\n\n  override async setCacheEnabled(enabled?: boolean): Promise<void> {\n    if (!this.#browserContext.browser().cdpSupported) {\n      await this.#frame.browsingContext.setCacheBehavior(\n        enabled ? 'default' : 'bypass'\n      );\n      return;\n    }\n    // TODO: handle CDP-specific cases such as mprach.\n    await this._client().send('Network.setCacheDisabled', {\n      cacheDisabled: !enabled,\n    });\n  }\n\n  override async cookies(...urls: string[]): Promise<Cookie[]> {\n    const normalizedUrls = (urls.length ? urls : [this.url()]).map(url => {\n      return new URL(url);\n    });\n\n    const cookies = await this.#frame.browsingContext.getCookies();\n    return cookies\n      .map(cookie => {\n        return bidiToPuppeteerCookie(cookie);\n      })\n      .filter(cookie => {\n        return normalizedUrls.some(url => {\n          return testUrlMatchCookie(cookie, url);\n        });\n      });\n  }\n\n  override isServiceWorkerBypassed(): never {\n    throw new UnsupportedOperation();\n  }\n\n  override target(): never {\n    throw new UnsupportedOperation();\n  }\n\n  override waitForFileChooser(): never {\n    throw new UnsupportedOperation();\n  }\n\n  override workers(): BidiWebWorker[] {\n    return [...this.#workers];\n  }\n\n  #userInterception?: string;\n  override async setRequestInterception(enable: boolean): Promise<void> {\n    this.#userInterception = await this.#toggleInterception(\n      [Bidi.Network.InterceptPhase.BeforeRequestSent],\n      this.#userInterception,\n      enable\n    );\n  }\n\n  /**\n   * @internal\n   */\n  _extraHTTPHeaders: Record<string, string> = {};\n  #extraHeadersInterception?: string;\n  override async setExtraHTTPHeaders(\n    headers: Record<string, string>\n  ): Promise<void> {\n    const extraHTTPHeaders: Record<string, string> = {};\n    for (const [key, value] of Object.entries(headers)) {\n      assert(\n        isString(value),\n        `Expected value of header \"${key}\" to be String, but \"${typeof value}\" is found.`\n      );\n      extraHTTPHeaders[key.toLowerCase()] = value;\n    }\n    this._extraHTTPHeaders = extraHTTPHeaders;\n\n    this.#extraHeadersInterception = await this.#toggleInterception(\n      [Bidi.Network.InterceptPhase.BeforeRequestSent],\n      this.#extraHeadersInterception,\n      Boolean(Object.keys(this._extraHTTPHeaders).length)\n    );\n  }\n\n  /**\n   * @internal\n   */\n  _credentials: Credentials | null = null;\n  #authInterception?: string;\n  override async authenticate(credentials: Credentials | null): Promise<void> {\n    this.#authInterception = await this.#toggleInterception(\n      [Bidi.Network.InterceptPhase.AuthRequired],\n      this.#authInterception,\n      Boolean(credentials)\n    );\n\n    this._credentials = credentials;\n  }\n\n  async #toggleInterception(\n    phases: [Bidi.Network.InterceptPhase, ...Bidi.Network.InterceptPhase[]],\n    interception: string | undefined,\n    expected: boolean\n  ): Promise<string | undefined> {\n    if (expected && !interception) {\n      return await this.#frame.browsingContext.addIntercept({\n        phases,\n      });\n    } else if (!expected && interception) {\n      await this.#frame.browsingContext.userContext.browser.removeIntercept(\n        interception\n      );\n      return;\n    }\n    return interception;\n  }\n\n  override setDragInterception(): never {\n    throw new UnsupportedOperation();\n  }\n\n  override setBypassServiceWorker(): never {\n    throw new UnsupportedOperation();\n  }\n\n  override async setOfflineMode(enabled: boolean): Promise<void> {\n    if (!this.#browserContext.browser().cdpSupported) {\n      throw new UnsupportedOperation();\n    }\n\n    if (!this.#emulatedNetworkConditions) {\n      this.#emulatedNetworkConditions = {\n        offline: false,\n        upload: -1,\n        download: -1,\n        latency: 0,\n      };\n    }\n    this.#emulatedNetworkConditions.offline = enabled;\n    return await this.#applyNetworkConditions();\n  }\n\n  override async emulateNetworkConditions(\n    networkConditions: NetworkConditions | null\n  ): Promise<void> {\n    if (!this.#browserContext.browser().cdpSupported) {\n      throw new UnsupportedOperation();\n    }\n    if (!this.#emulatedNetworkConditions) {\n      this.#emulatedNetworkConditions = {\n        offline: false,\n        upload: -1,\n        download: -1,\n        latency: 0,\n      };\n    }\n    this.#emulatedNetworkConditions.upload = networkConditions\n      ? networkConditions.upload\n      : -1;\n    this.#emulatedNetworkConditions.download = networkConditions\n      ? networkConditions.download\n      : -1;\n    this.#emulatedNetworkConditions.latency = networkConditions\n      ? networkConditions.latency\n      : 0;\n    return await this.#applyNetworkConditions();\n  }\n\n  async #applyNetworkConditions(): Promise<void> {\n    if (!this.#emulatedNetworkConditions) {\n      return;\n    }\n    await this._client().send('Network.emulateNetworkConditions', {\n      offline: this.#emulatedNetworkConditions.offline,\n      latency: this.#emulatedNetworkConditions.latency,\n      uploadThroughput: this.#emulatedNetworkConditions.upload,\n      downloadThroughput: this.#emulatedNetworkConditions.download,\n    });\n  }\n\n  override async setCookie(...cookies: CookieParam[]): Promise<void> {\n    const pageURL = this.url();\n    const pageUrlStartsWithHTTP = pageURL.startsWith('http');\n    for (const cookie of cookies) {\n      let cookieUrl = cookie.url || '';\n      if (!cookieUrl && pageUrlStartsWithHTTP) {\n        cookieUrl = pageURL;\n      }\n      assert(\n        cookieUrl !== 'about:blank',\n        `Blank page can not have cookie \"${cookie.name}\"`\n      );\n      assert(\n        !String.prototype.startsWith.call(cookieUrl || '', 'data:'),\n        `Data URL page can not have cookie \"${cookie.name}\"`\n      );\n\n      const normalizedUrl = URL.canParse(cookieUrl)\n        ? new URL(cookieUrl)\n        : undefined;\n\n      const domain = cookie.domain ?? normalizedUrl?.hostname;\n      assert(\n        domain !== undefined,\n        `At least one of the url and domain needs to be specified`\n      );\n\n      const bidiCookie: Bidi.Storage.PartialCookie = {\n        domain: domain,\n        name: cookie.name,\n        value: {\n          type: 'string',\n          value: cookie.value,\n        },\n        ...(cookie.path !== undefined ? {path: cookie.path} : {}),\n        ...(cookie.httpOnly !== undefined ? {httpOnly: cookie.httpOnly} : {}),\n        ...(cookie.secure !== undefined ? {secure: cookie.secure} : {}),\n        ...(cookie.sameSite !== undefined\n          ? {sameSite: convertCookiesSameSiteCdpToBiDi(cookie.sameSite)}\n          : {}),\n        ...(cookie.expires !== undefined ? {expiry: cookie.expires} : {}),\n        // Chrome-specific properties.\n        ...cdpSpecificCookiePropertiesFromPuppeteerToBidi(\n          cookie,\n          'sameParty',\n          'sourceScheme',\n          'priority',\n          'url'\n        ),\n      };\n\n      if (cookie.partitionKey !== undefined) {\n        await this.browserContext().userContext.setCookie(\n          bidiCookie,\n          cookie.partitionKey\n        );\n      } else {\n        await this.#frame.browsingContext.setCookie(bidiCookie);\n      }\n    }\n  }\n\n  override async deleteCookie(\n    ...cookies: DeleteCookiesRequest[]\n  ): Promise<void> {\n    await Promise.all(\n      cookies.map(async deleteCookieRequest => {\n        const cookieUrl = deleteCookieRequest.url ?? this.url();\n        const normalizedUrl = URL.canParse(cookieUrl)\n          ? new URL(cookieUrl)\n          : undefined;\n\n        const domain = deleteCookieRequest.domain ?? normalizedUrl?.hostname;\n        assert(\n          domain !== undefined,\n          `At least one of the url and domain needs to be specified`\n        );\n\n        const filter = {\n          domain: domain,\n          name: deleteCookieRequest.name,\n          ...(deleteCookieRequest.path !== undefined\n            ? {path: deleteCookieRequest.path}\n            : {}),\n        };\n        await this.#frame.browsingContext.deleteCookie(filter);\n      })\n    );\n  }\n\n  override async removeExposedFunction(name: string): Promise<void> {\n    await this.#frame.removeExposedFunction(name);\n  }\n\n  override metrics(): never {\n    throw new UnsupportedOperation();\n  }\n\n  override async goBack(\n    options: WaitForOptions = {}\n  ): Promise<HTTPResponse | null> {\n    return await this.#go(-1, options);\n  }\n\n  override async goForward(\n    options: WaitForOptions = {}\n  ): Promise<HTTPResponse | null> {\n    return await this.#go(1, options);\n  }\n\n  async #go(\n    delta: number,\n    options: WaitForOptions\n  ): Promise<HTTPResponse | null> {\n    const controller = new AbortController();\n\n    try {\n      const [response] = await Promise.all([\n        this.waitForNavigation({\n          ...options,\n          signal: controller.signal,\n        }),\n        this.#frame.browsingContext.traverseHistory(delta),\n      ]);\n      return response;\n    } catch (error) {\n      controller.abort();\n      if (isErrorLike(error)) {\n        if (error.message.includes('no such history entry')) {\n          return null;\n        }\n      }\n      throw error;\n    }\n  }\n\n  override waitForDevicePrompt(): never {\n    throw new UnsupportedOperation();\n  }\n}\n\nfunction evaluationExpression(fun: Function | string, ...args: unknown[]) {\n  return `() => {${evaluationString(fun, ...args)}}`;\n}\n\n/**\n * Check domains match.\n * According to cookies spec, this check should match subdomains as well, but CDP\n * implementation does not do that, so this method matches only the exact domains, not\n * what is written in the spec:\n * https://datatracker.ietf.org/doc/html/rfc6265#section-5.1.3\n */\nfunction testUrlMatchCookieHostname(\n  cookie: Cookie,\n  normalizedUrl: URL\n): boolean {\n  const cookieDomain = cookie.domain.toLowerCase();\n  const urlHostname = normalizedUrl.hostname.toLowerCase();\n  return cookieDomain === urlHostname;\n}\n\n/**\n * Check paths match.\n * Spec: https://datatracker.ietf.org/doc/html/rfc6265#section-5.1.4\n */\nfunction testUrlMatchCookiePath(cookie: Cookie, normalizedUrl: URL): boolean {\n  const uriPath = normalizedUrl.pathname;\n  const cookiePath = cookie.path;\n\n  if (uriPath === cookiePath) {\n    // The cookie-path and the request-path are identical.\n    return true;\n  }\n  if (uriPath.startsWith(cookiePath)) {\n    // The cookie-path is a prefix of the request-path.\n    if (cookiePath.endsWith('/')) {\n      // The last character of the cookie-path is %x2F (\"/\").\n      return true;\n    }\n    if (uriPath[cookiePath.length] === '/') {\n      // The first character of the request-path that is not included in the cookie-path\n      // is a %x2F (\"/\") character.\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Checks the cookie matches the URL according to the spec:\n */\nfunction testUrlMatchCookie(cookie: Cookie, url: URL): boolean {\n  const normalizedUrl = new URL(url);\n  assert(cookie !== undefined);\n  if (!testUrlMatchCookieHostname(cookie, normalizedUrl)) {\n    return false;\n  }\n  return testUrlMatchCookiePath(cookie, normalizedUrl);\n}\n\nfunction bidiToPuppeteerCookie(bidiCookie: Bidi.Network.Cookie): Cookie {\n  const partitionKey = bidiCookie[CDP_SPECIFIC_PREFIX + 'partitionKey'];\n\n  function getParitionKey(): {partitionKey?: string} {\n    if (typeof partitionKey === 'string') {\n      return {partitionKey};\n    }\n    if (typeof partitionKey === 'object' && partitionKey !== null) {\n      return {\n        // TODO: a breaking change in Puppeteer is required to change\n        // partitionKey type and report the composite partition key.\n        partitionKey: partitionKey.topLevelSite,\n      };\n    }\n    return {};\n  }\n\n  return {\n    name: bidiCookie.name,\n    // Presents binary value as base64 string.\n    value: bidiCookie.value.value,\n    domain: bidiCookie.domain,\n    path: bidiCookie.path,\n    size: bidiCookie.size,\n    httpOnly: bidiCookie.httpOnly,\n    secure: bidiCookie.secure,\n    sameSite: convertCookiesSameSiteBiDiToCdp(bidiCookie.sameSite),\n    expires: bidiCookie.expiry ?? -1,\n    session: bidiCookie.expiry === undefined || bidiCookie.expiry <= 0,\n    // Extending with CDP-specific properties with `goog:` prefix.\n    ...cdpSpecificCookiePropertiesFromBidiToPuppeteer(\n      bidiCookie,\n      'sameParty',\n      'sourceScheme',\n      'partitionKeyOpaque',\n      'priority'\n    ),\n    ...getParitionKey(),\n  };\n}\n\nconst CDP_SPECIFIC_PREFIX = 'goog:';\n\n/**\n * Gets CDP-specific properties from the BiDi cookie and returns them as a new object.\n */\nfunction cdpSpecificCookiePropertiesFromBidiToPuppeteer(\n  bidiCookie: Bidi.Network.Cookie,\n  ...propertyNames: Array<keyof Cookie>\n): Partial<Cookie> {\n  const result: Partial<Cookie> = {};\n  for (const property of propertyNames) {\n    if (bidiCookie[CDP_SPECIFIC_PREFIX + property] !== undefined) {\n      result[property] = bidiCookie[CDP_SPECIFIC_PREFIX + property];\n    }\n  }\n  return result;\n}\n\n/**\n * Gets CDP-specific properties from the cookie, adds CDP-specific prefixes and returns\n * them as a new object which can be used in BiDi.\n */\nfunction cdpSpecificCookiePropertiesFromPuppeteerToBidi(\n  cookieParam: CookieParam,\n  ...propertyNames: Array<keyof CookieParam>\n): Record<string, unknown> {\n  const result: Record<string, unknown> = {};\n  for (const property of propertyNames) {\n    if (cookieParam[property] !== undefined) {\n      result[CDP_SPECIFIC_PREFIX + property] = cookieParam[property];\n    }\n  }\n  return result;\n}\n\nfunction convertCookiesSameSiteBiDiToCdp(\n  sameSite: Bidi.Network.SameSite | undefined\n): CookieSameSite {\n  return sameSite === 'strict' ? 'Strict' : sameSite === 'lax' ? 'Lax' : 'None';\n}\n\nfunction convertCookiesSameSiteCdpToBiDi(\n  sameSite: CookieSameSite | undefined\n): Bidi.Network.SameSite {\n  return sameSite === 'Strict'\n    ? Bidi.Network.SameSite.Strict\n    : sameSite === 'Lax'\n      ? Bidi.Network.SameSite.Lax\n      : Bidi.Network.SameSite.None;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}