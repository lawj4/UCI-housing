{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Realm = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nconst log_js_1 = require(\"../../../utils/log.js\");\nconst uuid_js_1 = require(\"../../../utils/uuid.js\");\nconst ChannelProxy_js_1 = require(\"./ChannelProxy.js\");\nclass Realm {\n  #cdpClient;\n  #eventManager;\n  #executionContextId;\n  #logger;\n  #origin;\n  #realmId;\n  #realmStorage;\n  constructor(cdpClient, eventManager, executionContextId, logger, origin, realmId, realmStorage) {\n    this.#cdpClient = cdpClient;\n    this.#eventManager = eventManager;\n    this.#executionContextId = executionContextId;\n    this.#logger = logger;\n    this.#origin = origin;\n    this.#realmId = realmId;\n    this.#realmStorage = realmStorage;\n    this.#realmStorage.addRealm(this);\n  }\n  cdpToBidiValue(cdpValue, resultOwnership) {\n    const bidiValue = this.serializeForBiDi(cdpValue.result.deepSerializedValue, new Map());\n    if (cdpValue.result.objectId) {\n      const objectId = cdpValue.result.objectId;\n      if (resultOwnership === \"root\" /* Script.ResultOwnership.Root */) {\n        // Extend BiDi value with `handle` based on required `resultOwnership`\n        // and  CDP response but not on the actual BiDi type.\n        bidiValue.handle = objectId;\n        // Remember all the handles sent to client.\n        this.#realmStorage.knownHandlesToRealmMap.set(objectId, this.realmId);\n      } else {\n        // No need to await for the object to be released.\n        void this.#releaseObject(objectId).catch(error => this.#logger?.(log_js_1.LogType.debugError, error));\n      }\n    }\n    return bidiValue;\n  }\n  /**\n   * Relies on the CDP to implement proper BiDi serialization, except:\n   * * CDP integer property `backendNodeId` is replaced with `sharedId` of\n   * `{documentId}_element_{backendNodeId}`;\n   * * CDP integer property `weakLocalObjectReference` is replaced with UUID `internalId`\n   * using unique-per serialization `internalIdMap`.\n   * * CDP type `platformobject` is replaced with `object`.\n   * @param deepSerializedValue - CDP value to be converted to BiDi.\n   * @param internalIdMap - Map from CDP integer `weakLocalObjectReference` to BiDi UUID\n   * `internalId`.\n   */\n  serializeForBiDi(deepSerializedValue, internalIdMap) {\n    if (Object.hasOwn(deepSerializedValue, 'weakLocalObjectReference')) {\n      const weakLocalObjectReference = deepSerializedValue.weakLocalObjectReference;\n      if (!internalIdMap.has(weakLocalObjectReference)) {\n        internalIdMap.set(weakLocalObjectReference, (0, uuid_js_1.uuidv4)());\n      }\n      deepSerializedValue.internalId = internalIdMap.get(weakLocalObjectReference);\n      delete deepSerializedValue['weakLocalObjectReference'];\n    }\n    // Platform object is a special case. It should have only `{type: object}`\n    // without `value` field.\n    if (deepSerializedValue.type === 'platformobject') {\n      return {\n        type: 'object'\n      };\n    }\n    const bidiValue = deepSerializedValue.value;\n    if (bidiValue === undefined) {\n      return deepSerializedValue;\n    }\n    // Recursively update the nested values.\n    if (['array', 'set', 'htmlcollection', 'nodelist'].includes(deepSerializedValue.type)) {\n      for (const i in bidiValue) {\n        bidiValue[i] = this.serializeForBiDi(bidiValue[i], internalIdMap);\n      }\n    }\n    if (['object', 'map'].includes(deepSerializedValue.type)) {\n      for (const i in bidiValue) {\n        bidiValue[i] = [this.serializeForBiDi(bidiValue[i][0], internalIdMap), this.serializeForBiDi(bidiValue[i][1], internalIdMap)];\n      }\n    }\n    return deepSerializedValue;\n  }\n  get realmId() {\n    return this.#realmId;\n  }\n  get executionContextId() {\n    return this.#executionContextId;\n  }\n  get origin() {\n    return this.#origin;\n  }\n  get source() {\n    return {\n      realm: this.realmId\n    };\n  }\n  get cdpClient() {\n    return this.#cdpClient;\n  }\n  get baseInfo() {\n    return {\n      realm: this.realmId,\n      origin: this.origin\n    };\n  }\n  async evaluate(expression, awaitPromise, resultOwnership = \"none\" /* Script.ResultOwnership.None */, serializationOptions = {}, userActivation = false, includeCommandLineApi = false) {\n    const cdpEvaluateResult = await this.cdpClient.sendCommand('Runtime.evaluate', {\n      contextId: this.executionContextId,\n      expression,\n      awaitPromise,\n      serializationOptions: Realm.#getSerializationOptions(\"deep\" /* Protocol.Runtime.SerializationOptionsSerialization.Deep */, serializationOptions),\n      userGesture: userActivation,\n      includeCommandLineAPI: includeCommandLineApi\n    });\n    if (cdpEvaluateResult.exceptionDetails) {\n      return await this.#getExceptionResult(cdpEvaluateResult.exceptionDetails, 0, resultOwnership);\n    }\n    return {\n      realm: this.realmId,\n      result: this.cdpToBidiValue(cdpEvaluateResult, resultOwnership),\n      type: 'success'\n    };\n  }\n  #registerEvent(event) {\n    if (this.associatedBrowsingContexts.length === 0) {\n      this.#eventManager.registerEvent(event, null);\n    } else {\n      for (const browsingContext of this.associatedBrowsingContexts) {\n        this.#eventManager.registerEvent(event, browsingContext.id);\n      }\n    }\n  }\n  initialize() {\n    this.#registerEvent({\n      type: 'event',\n      method: protocol_js_1.ChromiumBidi.Script.EventNames.RealmCreated,\n      params: this.realmInfo\n    });\n  }\n  /**\n   * Serializes a given CDP object into BiDi, keeping references in the\n   * target's `globalThis`.\n   */\n  async serializeCdpObject(cdpRemoteObject, resultOwnership) {\n    const argument = Realm.#cdpRemoteObjectToCallArgument(cdpRemoteObject);\n    const cdpValue = await this.cdpClient.sendCommand('Runtime.callFunctionOn', {\n      functionDeclaration: String(remoteObject => remoteObject),\n      awaitPromise: false,\n      arguments: [argument],\n      serializationOptions: {\n        serialization: \"deep\" /* Protocol.Runtime.SerializationOptionsSerialization.Deep */\n      },\n      executionContextId: this.executionContextId\n    });\n    return this.cdpToBidiValue(cdpValue, resultOwnership);\n  }\n  static #cdpRemoteObjectToCallArgument(cdpRemoteObject) {\n    if (cdpRemoteObject.objectId !== undefined) {\n      return {\n        objectId: cdpRemoteObject.objectId\n      };\n    }\n    if (cdpRemoteObject.unserializableValue !== undefined) {\n      return {\n        unserializableValue: cdpRemoteObject.unserializableValue\n      };\n    }\n    return {\n      value: cdpRemoteObject.value\n    };\n  }\n  /**\n   * Gets the string representation of an object. This is equivalent to\n   * calling `toString()` on the object value.\n   */\n  async stringifyObject(cdpRemoteObject) {\n    const {\n      result\n    } = await this.cdpClient.sendCommand('Runtime.callFunctionOn', {\n      functionDeclaration: String(remoteObject => String(remoteObject)),\n      awaitPromise: false,\n      arguments: [cdpRemoteObject],\n      returnByValue: true,\n      executionContextId: this.executionContextId\n    });\n    return result.value;\n  }\n  async #flattenKeyValuePairs(mappingLocalValue) {\n    const keyValueArray = await Promise.all(mappingLocalValue.map(async ([key, value]) => {\n      let keyArg;\n      if (typeof key === 'string') {\n        // Key is a string.\n        keyArg = {\n          value: key\n        };\n      } else {\n        // Key is a serialized value.\n        keyArg = await this.deserializeForCdp(key);\n      }\n      const valueArg = await this.deserializeForCdp(value);\n      return [keyArg, valueArg];\n    }));\n    return keyValueArray.flat();\n  }\n  async #flattenValueList(listLocalValue) {\n    return await Promise.all(listLocalValue.map(localValue => this.deserializeForCdp(localValue)));\n  }\n  async #serializeCdpExceptionDetails(cdpExceptionDetails, lineOffset, resultOwnership) {\n    const callFrames = cdpExceptionDetails.stackTrace?.callFrames.map(frame => ({\n      url: frame.url,\n      functionName: frame.functionName,\n      lineNumber: frame.lineNumber - lineOffset,\n      columnNumber: frame.columnNumber\n    })) ?? [];\n    // Exception should always be there.\n    const exception = cdpExceptionDetails.exception;\n    return {\n      exception: await this.serializeCdpObject(exception, resultOwnership),\n      columnNumber: cdpExceptionDetails.columnNumber,\n      lineNumber: cdpExceptionDetails.lineNumber - lineOffset,\n      stackTrace: {\n        callFrames\n      },\n      text: (await this.stringifyObject(exception)) || cdpExceptionDetails.text\n    };\n  }\n  async callFunction(functionDeclaration, awaitPromise, thisLocalValue = {\n    type: 'undefined'\n  }, argumentsLocalValues = [], resultOwnership = \"none\" /* Script.ResultOwnership.None */, serializationOptions = {}, userActivation = false) {\n    const callFunctionAndSerializeScript = `(...args) => {\n      function callFunction(f, args) {\n        const deserializedThis = args.shift();\n        const deserializedArgs = args;\n        return f.apply(deserializedThis, deserializedArgs);\n      }\n      return callFunction((\n        ${functionDeclaration}\n      ), args);\n    }`;\n    const thisAndArgumentsList = [await this.deserializeForCdp(thisLocalValue), ...(await Promise.all(argumentsLocalValues.map(async argumentLocalValue => await this.deserializeForCdp(argumentLocalValue))))];\n    let cdpCallFunctionResult;\n    try {\n      cdpCallFunctionResult = await this.cdpClient.sendCommand('Runtime.callFunctionOn', {\n        functionDeclaration: callFunctionAndSerializeScript,\n        awaitPromise,\n        arguments: thisAndArgumentsList,\n        serializationOptions: Realm.#getSerializationOptions(\"deep\" /* Protocol.Runtime.SerializationOptionsSerialization.Deep */, serializationOptions),\n        executionContextId: this.executionContextId,\n        userGesture: userActivation\n      });\n    } catch (error) {\n      // Heuristic to determine if the problem is in the argument.\n      // The check can be done on the `deserialization` step, but this approach\n      // helps to save round-trips.\n      if (error.code === -32000 /* CdpErrorConstants.GENERIC_ERROR */ && ['Could not find object with given id', 'Argument should belong to the same JavaScript world as target object', 'Invalid remote object id'].includes(error.message)) {\n        throw new protocol_js_1.NoSuchHandleException('Handle was not found.');\n      }\n      throw error;\n    }\n    if (cdpCallFunctionResult.exceptionDetails) {\n      return await this.#getExceptionResult(cdpCallFunctionResult.exceptionDetails, 1, resultOwnership);\n    }\n    return {\n      type: 'success',\n      result: this.cdpToBidiValue(cdpCallFunctionResult, resultOwnership),\n      realm: this.realmId\n    };\n  }\n  async deserializeForCdp(localValue) {\n    if ('handle' in localValue && localValue.handle) {\n      return {\n        objectId: localValue.handle\n      };\n      // We tried to find a handle value but failed\n      // This allows us to have exhaustive switch on `localValue.type`\n    } else if ('handle' in localValue || 'sharedId' in localValue) {\n      throw new protocol_js_1.NoSuchHandleException('Handle was not found.');\n    }\n    switch (localValue.type) {\n      case 'undefined':\n        return {\n          unserializableValue: 'undefined'\n        };\n      case 'null':\n        return {\n          unserializableValue: 'null'\n        };\n      case 'string':\n        return {\n          value: localValue.value\n        };\n      case 'number':\n        if (localValue.value === 'NaN') {\n          return {\n            unserializableValue: 'NaN'\n          };\n        } else if (localValue.value === '-0') {\n          return {\n            unserializableValue: '-0'\n          };\n        } else if (localValue.value === 'Infinity') {\n          return {\n            unserializableValue: 'Infinity'\n          };\n        } else if (localValue.value === '-Infinity') {\n          return {\n            unserializableValue: '-Infinity'\n          };\n        }\n        return {\n          value: localValue.value\n        };\n      case 'boolean':\n        return {\n          value: Boolean(localValue.value)\n        };\n      case 'bigint':\n        return {\n          unserializableValue: `BigInt(${JSON.stringify(localValue.value)})`\n        };\n      case 'date':\n        return {\n          unserializableValue: `new Date(Date.parse(${JSON.stringify(localValue.value)}))`\n        };\n      case 'regexp':\n        return {\n          unserializableValue: `new RegExp(${JSON.stringify(localValue.value.pattern)}, ${JSON.stringify(localValue.value.flags)})`\n        };\n      case 'map':\n        {\n          // TODO: If none of the nested keys and values has a remote\n          // reference, serialize to `unserializableValue` without CDP roundtrip.\n          const keyValueArray = await this.#flattenKeyValuePairs(localValue.value);\n          const {\n            result\n          } = await this.cdpClient.sendCommand('Runtime.callFunctionOn', {\n            functionDeclaration: String((...args) => {\n              const result = new Map();\n              for (let i = 0; i < args.length; i += 2) {\n                result.set(args[i], args[i + 1]);\n              }\n              return result;\n            }),\n            awaitPromise: false,\n            arguments: keyValueArray,\n            returnByValue: false,\n            executionContextId: this.executionContextId\n          });\n          // TODO(#375): Release `result.objectId` after using.\n          return {\n            objectId: result.objectId\n          };\n        }\n      case 'object':\n        {\n          // TODO: If none of the nested keys and values has a remote\n          // reference, serialize to `unserializableValue` without CDP roundtrip.\n          const keyValueArray = await this.#flattenKeyValuePairs(localValue.value);\n          const {\n            result\n          } = await this.cdpClient.sendCommand('Runtime.callFunctionOn', {\n            functionDeclaration: String((...args) => {\n              const result = {};\n              for (let i = 0; i < args.length; i += 2) {\n                // Key should be either `string`, `number`, or `symbol`.\n                const key = args[i];\n                result[key] = args[i + 1];\n              }\n              return result;\n            }),\n            awaitPromise: false,\n            arguments: keyValueArray,\n            returnByValue: false,\n            executionContextId: this.executionContextId\n          });\n          // TODO(#375): Release `result.objectId` after using.\n          return {\n            objectId: result.objectId\n          };\n        }\n      case 'array':\n        {\n          // TODO: If none of the nested items has a remote reference,\n          // serialize to `unserializableValue` without CDP roundtrip.\n          const args = await this.#flattenValueList(localValue.value);\n          const {\n            result\n          } = await this.cdpClient.sendCommand('Runtime.callFunctionOn', {\n            functionDeclaration: String((...args) => args),\n            awaitPromise: false,\n            arguments: args,\n            returnByValue: false,\n            executionContextId: this.executionContextId\n          });\n          // TODO(#375): Release `result.objectId` after using.\n          return {\n            objectId: result.objectId\n          };\n        }\n      case 'set':\n        {\n          // TODO: if none of the nested items has a remote reference,\n          // serialize to `unserializableValue` without CDP roundtrip.\n          const args = await this.#flattenValueList(localValue.value);\n          const {\n            result\n          } = await this.cdpClient.sendCommand('Runtime.callFunctionOn', {\n            functionDeclaration: String((...args) => new Set(args)),\n            awaitPromise: false,\n            arguments: args,\n            returnByValue: false,\n            executionContextId: this.executionContextId\n          });\n          // TODO(#375): Release `result.objectId` after using.\n          return {\n            objectId: result.objectId\n          };\n        }\n      case 'channel':\n        {\n          const channelProxy = new ChannelProxy_js_1.ChannelProxy(localValue.value, this.#logger);\n          const channelProxySendMessageHandle = await channelProxy.init(this, this.#eventManager);\n          return {\n            objectId: channelProxySendMessageHandle\n          };\n        }\n      // TODO(#375): Dispose of nested objects.\n    }\n    // Intentionally outside to handle unknown types\n    throw new Error(`Value ${JSON.stringify(localValue)} is not deserializable.`);\n  }\n  async #getExceptionResult(exceptionDetails, lineOffset, resultOwnership) {\n    return {\n      exceptionDetails: await this.#serializeCdpExceptionDetails(exceptionDetails, lineOffset, resultOwnership),\n      realm: this.realmId,\n      type: 'exception'\n    };\n  }\n  static #getSerializationOptions(serialization, serializationOptions) {\n    return {\n      serialization,\n      additionalParameters: Realm.#getAdditionalSerializationParameters(serializationOptions),\n      ...Realm.#getMaxObjectDepth(serializationOptions)\n    };\n  }\n  static #getAdditionalSerializationParameters(serializationOptions) {\n    const additionalParameters = {};\n    if (serializationOptions.maxDomDepth !== undefined) {\n      additionalParameters['maxNodeDepth'] = serializationOptions.maxDomDepth === null ? 1000 : serializationOptions.maxDomDepth;\n    }\n    if (serializationOptions.includeShadowTree !== undefined) {\n      additionalParameters['includeShadowTree'] = serializationOptions.includeShadowTree;\n    }\n    return additionalParameters;\n  }\n  static #getMaxObjectDepth(serializationOptions) {\n    return serializationOptions.maxObjectDepth === undefined || serializationOptions.maxObjectDepth === null ? {} : {\n      maxDepth: serializationOptions.maxObjectDepth\n    };\n  }\n  async #releaseObject(handle) {\n    try {\n      await this.cdpClient.sendCommand('Runtime.releaseObject', {\n        objectId: handle\n      });\n    } catch (error) {\n      // Heuristic to determine if the problem is in the unknown handler.\n      // Ignore the error if so.\n      if (!(error.code === -32000 /* CdpErrorConstants.GENERIC_ERROR */ && error.message === 'Invalid remote object id')) {\n        throw error;\n      }\n    }\n  }\n  async disown(handle) {\n    // Disowning an object from different realm does nothing.\n    if (this.#realmStorage.knownHandlesToRealmMap.get(handle) !== this.realmId) {\n      return;\n    }\n    await this.#releaseObject(handle);\n    this.#realmStorage.knownHandlesToRealmMap.delete(handle);\n  }\n  dispose() {\n    this.#registerEvent({\n      type: 'event',\n      method: protocol_js_1.ChromiumBidi.Script.EventNames.RealmDestroyed,\n      params: {\n        realm: this.realmId\n      }\n    });\n  }\n}\nexports.Realm = Realm;","map":{"version":3,"names":["protocol_js_1","require","log_js_1","uuid_js_1","ChannelProxy_js_1","Realm","cdpClient","eventManager","executionContextId","logger","origin","realmId","realmStorage","constructor","addRealm","cdpToBidiValue","cdpValue","resultOwnership","bidiValue","serializeForBiDi","result","deepSerializedValue","Map","objectId","handle","knownHandlesToRealmMap","set","releaseObject","catch","error","LogType","debugError","internalIdMap","Object","hasOwn","weakLocalObjectReference","has","uuidv4","internalId","get","type","value","undefined","includes","i","source","realm","baseInfo","evaluate","expression","awaitPromise","serializationOptions","userActivation","includeCommandLineApi","cdpEvaluateResult","sendCommand","contextId","getSerializationOptions","userGesture","includeCommandLineAPI","exceptionDetails","getExceptionResult","registerEvent","#registerEvent","event","associatedBrowsingContexts","length","browsingContext","id","initialize","method","ChromiumBidi","Script","EventNames","RealmCreated","params","realmInfo","serializeCdpObject","cdpRemoteObject","argument","cdpRemoteObjectToCallArgument","functionDeclaration","String","remoteObject","arguments","serialization","#cdpRemoteObjectToCallArgument","unserializableValue","stringifyObject","returnByValue","flattenKeyValuePairs","#flattenKeyValuePairs","mappingLocalValue","keyValueArray","Promise","all","map","key","keyArg","deserializeForCdp","valueArg","flat","flattenValueList","#flattenValueList","listLocalValue","localValue","serializeCdpExceptionDetails","#serializeCdpExceptionDetails","cdpExceptionDetails","lineOffset","callFrames","stackTrace","frame","url","functionName","lineNumber","columnNumber","exception","text","callFunction","thisLocalValue","argumentsLocalValues","callFunctionAndSerializeScript","thisAndArgumentsList","argumentLocalValue","cdpCallFunctionResult","code","message","NoSuchHandleException","Boolean","JSON","stringify","pattern","flags","args","Set","channelProxy","ChannelProxy","channelProxySendMessageHandle","init","Error","#getExceptionResult","#getSerializationOptions","additionalParameters","getAdditionalSerializationParameters","getMaxObjectDepth","#getAdditionalSerializationParameters","maxDomDepth","includeShadowTree","#getMaxObjectDepth","maxObjectDepth","maxDepth","#releaseObject","disown","delete","dispose","RealmDestroyed","exports"],"sources":["../../../../../src/bidiMapper/modules/script/Realm.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}