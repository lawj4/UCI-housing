{"ast":null,"code":"\"use strict\";\n\n/**\n * @license\n * Copyright 2022 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.FrameTree = void 0;\nconst Deferred_js_1 = require(\"../util/Deferred.js\");\n/**\n * Keeps track of the page frame tree and it's is managed by\n * {@link FrameManager}. FrameTree uses frame IDs to reference frame and it\n * means that referenced frames might not be in the tree anymore. Thus, the tree\n * structure is eventually consistent.\n * @internal\n */\nclass FrameTree {\n  #frames = new Map();\n  // frameID -> parentFrameID\n  #parentIds = new Map();\n  // frameID -> childFrameIDs\n  #childIds = new Map();\n  #mainFrame;\n  #isMainFrameStale = false;\n  #waitRequests = new Map();\n  getMainFrame() {\n    return this.#mainFrame;\n  }\n  getById(frameId) {\n    return this.#frames.get(frameId);\n  }\n  /**\n   * Returns a promise that is resolved once the frame with\n   * the given ID is added to the tree.\n   */\n  waitForFrame(frameId) {\n    const frame = this.getById(frameId);\n    if (frame) {\n      return Promise.resolve(frame);\n    }\n    const deferred = Deferred_js_1.Deferred.create();\n    const callbacks = this.#waitRequests.get(frameId) || new Set();\n    callbacks.add(deferred);\n    return deferred.valueOrThrow();\n  }\n  frames() {\n    return Array.from(this.#frames.values());\n  }\n  addFrame(frame) {\n    this.#frames.set(frame._id, frame);\n    if (frame._parentId) {\n      this.#parentIds.set(frame._id, frame._parentId);\n      if (!this.#childIds.has(frame._parentId)) {\n        this.#childIds.set(frame._parentId, new Set());\n      }\n      this.#childIds.get(frame._parentId).add(frame._id);\n    } else if (!this.#mainFrame || this.#isMainFrameStale) {\n      this.#mainFrame = frame;\n      this.#isMainFrameStale = false;\n    }\n    this.#waitRequests.get(frame._id)?.forEach(request => {\n      return request.resolve(frame);\n    });\n  }\n  removeFrame(frame) {\n    this.#frames.delete(frame._id);\n    this.#parentIds.delete(frame._id);\n    if (frame._parentId) {\n      this.#childIds.get(frame._parentId)?.delete(frame._id);\n    } else {\n      this.#isMainFrameStale = true;\n    }\n  }\n  childFrames(frameId) {\n    const childIds = this.#childIds.get(frameId);\n    if (!childIds) {\n      return [];\n    }\n    return Array.from(childIds).map(id => {\n      return this.getById(id);\n    }).filter(frame => {\n      return frame !== undefined;\n    });\n  }\n  parentFrame(frameId) {\n    const parentId = this.#parentIds.get(frameId);\n    return parentId ? this.getById(parentId) : undefined;\n  }\n}\nexports.FrameTree = FrameTree;","map":{"version":3,"names":["Deferred_js_1","require","FrameTree","frames","Map","parentIds","childIds","mainFrame","isMainFrameStale","waitRequests","getMainFrame","getById","frameId","get","waitForFrame","frame","Promise","resolve","deferred","Deferred","create","callbacks","Set","add","valueOrThrow","Array","from","values","addFrame","set","_id","_parentId","has","forEach","request","removeFrame","delete","childFrames","map","id","filter","undefined","parentFrame","parentId","exports"],"sources":["/Users/lawj4/webDevelopment/Todo-List/frontend/node_modules/puppeteer-core/src/cdp/FrameTree.ts"],"sourcesContent":["/**\n * @license\n * Copyright 2022 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Frame} from '../api/Frame.js';\nimport {Deferred} from '../util/Deferred.js';\n\n/**\n * Keeps track of the page frame tree and it's is managed by\n * {@link FrameManager}. FrameTree uses frame IDs to reference frame and it\n * means that referenced frames might not be in the tree anymore. Thus, the tree\n * structure is eventually consistent.\n * @internal\n */\nexport class FrameTree<FrameType extends Frame> {\n  #frames = new Map<string, FrameType>();\n  // frameID -> parentFrameID\n  #parentIds = new Map<string, string>();\n  // frameID -> childFrameIDs\n  #childIds = new Map<string, Set<string>>();\n  #mainFrame?: FrameType;\n  #isMainFrameStale = false;\n  #waitRequests = new Map<string, Set<Deferred<FrameType>>>();\n\n  getMainFrame(): FrameType | undefined {\n    return this.#mainFrame;\n  }\n\n  getById(frameId: string): FrameType | undefined {\n    return this.#frames.get(frameId);\n  }\n\n  /**\n   * Returns a promise that is resolved once the frame with\n   * the given ID is added to the tree.\n   */\n  waitForFrame(frameId: string): Promise<FrameType> {\n    const frame = this.getById(frameId);\n    if (frame) {\n      return Promise.resolve(frame);\n    }\n    const deferred = Deferred.create<FrameType>();\n    const callbacks =\n      this.#waitRequests.get(frameId) || new Set<Deferred<FrameType>>();\n    callbacks.add(deferred);\n    return deferred.valueOrThrow();\n  }\n\n  frames(): FrameType[] {\n    return Array.from(this.#frames.values());\n  }\n\n  addFrame(frame: FrameType): void {\n    this.#frames.set(frame._id, frame);\n    if (frame._parentId) {\n      this.#parentIds.set(frame._id, frame._parentId);\n      if (!this.#childIds.has(frame._parentId)) {\n        this.#childIds.set(frame._parentId, new Set());\n      }\n      this.#childIds.get(frame._parentId)!.add(frame._id);\n    } else if (!this.#mainFrame || this.#isMainFrameStale) {\n      this.#mainFrame = frame;\n      this.#isMainFrameStale = false;\n    }\n    this.#waitRequests.get(frame._id)?.forEach(request => {\n      return request.resolve(frame);\n    });\n  }\n\n  removeFrame(frame: FrameType): void {\n    this.#frames.delete(frame._id);\n    this.#parentIds.delete(frame._id);\n    if (frame._parentId) {\n      this.#childIds.get(frame._parentId)?.delete(frame._id);\n    } else {\n      this.#isMainFrameStale = true;\n    }\n  }\n\n  childFrames(frameId: string): FrameType[] {\n    const childIds = this.#childIds.get(frameId);\n    if (!childIds) {\n      return [];\n    }\n    return Array.from(childIds)\n      .map(id => {\n        return this.getById(id);\n      })\n      .filter((frame): frame is FrameType => {\n        return frame !== undefined;\n      });\n  }\n\n  parentFrame(frameId: string): FrameType | undefined {\n    const parentId = this.#parentIds.get(frameId);\n    return parentId ? this.getById(parentId) : undefined;\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}